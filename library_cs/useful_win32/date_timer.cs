/*-------------------------------------------------------------------------

 DateTimeを使った時間測定
 精度はよくわからんが、PC起動時間に影響されない

---------------------------------------------------------------------------*/

/*-------------------------------------------------------------------------
 using
---------------------------------------------------------------------------*/
using System;

/*-------------------------------------------------------------------------
 
---------------------------------------------------------------------------*/
namespace useful
{
	/*-------------------------------------------------------------------------
	 
	---------------------------------------------------------------------------*/
	public class date_timer
	{
		private DateTime			m_elapsed_time_tmp;
		private DateTime			m_section_time_tmp;

		/*-------------------------------------------------------------------------
		 
		---------------------------------------------------------------------------*/
		public date_timer()
		{
			m_elapsed_time_tmp		= DateTime.Now;
			m_section_time_tmp		= DateTime.Now;
		}

		/*-------------------------------------------------------------------------
		 前回からの経過時間を得る
		 ミリセカンドで得る
		 1000 == 1秒
		---------------------------------------------------------------------------*/
		public int GetElapsedTimeMilliseconds()
		{
			DateTime	t		= DateTime.Now;
			int			e		= (int)(TimeSpan.FromTicks(sub_date_time(t, m_elapsed_time_tmp)).TotalMilliseconds);
			m_elapsed_time_tmp	= t;
			return e;
		}

		/*-------------------------------------------------------------------------
		 区間経過時間
		 計測開始
		---------------------------------------------------------------------------*/
		public void StartSection()
		{
			m_section_time_tmp		= DateTime.Now;
		}

		/*-------------------------------------------------------------------------
		 計測開始からの経過時間
		 1000 == 1秒
		---------------------------------------------------------------------------*/
		public int GetSectionTimeMilliseconds()
		{
			return (int)(TimeSpan.FromTicks(sub_date_time(DateTime.Now, m_section_time_tmp)).TotalMilliseconds);
		}

		/*-------------------------------------------------------------------------
		 差を得る
		 a - b を返す
		---------------------------------------------------------------------------*/
		public long sub_date_time(DateTime a, DateTime b)
		{
			return a.Ticks - b.Ticks;
		}
	}
}
